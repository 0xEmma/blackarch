pkgname=joomscan
pkgver=2012.03.11
pkgrel=4
pkgdesc="Detects file inclusion, sql injection, command execution vulnerabilities of a target Joomla! web site."
groups=('blackarch' 'blackarch-web-apps')
arch=('i686' 'x86_64')
depends=('perl-switch' 'perl-www-mechanize')
license=('LGPL3')
url='http://joomscan.sourceforge.net/'
source=("http://sourceforge.net/projects/joomscan/files/joomscan/${pkgver//./-}/joomscan-latest.zip")
md5sums=('82a8610dbee65bc587c05870910b545d')

package() {
  cd "$srcdir"

  # Base directories.
  install -dm755 "$pkgdir/usr/bin"
  install -dm755 "$pkgdir/usr/share/joomscan"
  install -dm755 "$pkgdir/usr/share/doc/joomscan"

  install -Dm755 "$srcdir/joomscan.pl" "$pkgdir/usr/share/joomscan/joomscan.pl"
  install -Dm755 "$srcdir/joomscandb.txt" "$pkgdir/usr/share/joomscan/joomscandb.txt"
  install -Dm755 "$srcdir/joomscandb-info.txt" "$pkgdir/usr/share/joomscan/joomscandb-info.txt"

  cp --no-preserve=ownership -r "$srcdir/doc"/* "$pkgdir/usr/share/doc/joomscan"
  cp --no-preserve=ownership -r "$srcdir/report" "$pkgdir/usr/share/joomscan"

  ln -s ../share/joomscan/joomscan.sh "$pkgdir/usr/bin/joomscan"
  ln -s ../doc/joomscan "$pkgdir/usr/share/joomscan/doc"

  install -Dm755 "$srcdir/joomscan.sh" "$pkgdir/usr/share/joomscan/joomscan.sh"
}
