# This file is part of BlackArch Linux ( http://blackarch.org ).
# See COPYING for license details.

pkgname='fakedns'
pkgver='0.1'
pkgrel=4
groups=('blackarch' 'blackarch-proxy' 'blackarch-spoof')
pkgdesc="A regular-expression based python MITM DNS server with correct DNS request passthrough and \"Not Found\" responses."
arch=('any')
url="https://github.com/Crypt0s/FakeDns"
license=('custom:unknown')
depends=('python2')
source=("https://github.com/Crypt0s/FakeDns/archive/master.zip")
sha1sums=('80e8b5c1a10f15104bca2ba99b29edb5d7218c27')

prepare() {
  cd "$srcdir/FakeDns-master"
  sed -i 's|bin/python$|bin/python2|' *.py
}

package() {
  cd "$srcdir/FakeDns-master"

  install -dm755 "$pkgdir/usr/bin/"
  install -dm755 "$pkgdir/usr/share/fakedns"
  install -dm755 "$pkgdir/usr/share/doc/fakedns"

  cp --no-preserve=ownership dns.conf fakedns.py "$pkgdir/usr/share/fakedns/"
  cp --no-preserve=ownership README.md "$pkgdir/usr/share/doc/fakedns/"

  chmod +x "$pkgdir/usr/share/fakedns/fakedns.py"

  ln -s "/usr/share/fakedns/fakedns.py" "$pkgdir/usr/bin/fakedns"
}
