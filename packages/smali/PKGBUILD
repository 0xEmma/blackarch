# This file is part of BlackArch Linux ( http://blackarch.org ).
# See COPYING for license details.

pkgname='smali'
pkgver='1.4.1'
pkgrel=5
groups=('blackarch' 'blackarch-hardware')
pkgdesc="An assembler/disassembler for Android's dex format"
arch=('any')
url='http://code.google.com/p/smali/'
license=("BSD")
depends=('java-environment')
source=("http://smali.googlecode.com/files/baksmali"
        "http://smali.googlecode.com/files/baksmali-$pkgver.jar"
        "http://smali.googlecode.com/files/smali"
        "http://smali.googlecode.com/files/smali-$pkgver.jar")
sha1sums=('f7c1899e133d1f826da1b169ec62fd47a6b3629e'
          '234d81df98b11018ddbcffe3eb8f326cae55c0ba'
          '29d9df50ab18a327153a91e0018145008771c040'
          '7a0aea9f691a2ac1948e0a6d6bbb187dc88401be')

package() {
  mkdir -p "$pkgdir/usr/bin"
  for file in baksmali smali; do
    install -D -m755 "$srcdir/$file" "$pkgdir/usr/share/smali/$file"

    # Prevent from printing path on launch.
    sed '/echo ${newProg}/d' -i "$pkgdir/usr/share/smali/$file"

    install -D -m644 "$srcdir/$file-$pkgver.jar" "$pkgdir/usr/share/smali/$file.jar"
    ln -s /usr/share/smali/$file "$pkgdir/usr/bin/$file"
  done
}
