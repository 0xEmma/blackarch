# This file is part of BlackArch Linux ( http://blackarch.org ).
# See COPYING for license details.

pkgname='cymothoa'
pkgver='1'
pkgrel=5
groups=('blackarch' 'blackarch-backdoor')
pkgdesc="A stealth backdooring tool, that inject backdoor's shellcode into an existing process."
url='http://cymothoa.sourceforge.net/'
arch=('i686' 'x86_64' 'armv6h' 'armv7h')
license=('GPL2')
source=("http://downloads.sourceforge.net/project/cymothoa/cymothoa-$pkgver-beta/cymothoa-$pkgver-beta.tar.gz"
'warnings.patch')
sha1sums=('95be2296fab6cf93a7275dbad78798a732c6fbce'
          '14034b3cf09d050efb6daeeac12d77799561012a')
if [[ $CARCH == arm* ]]; then
source=("http://downloads.sourceforge.net/project/cymothoa/cymothoa-$pkgver-beta/cymothoa-$pkgver-beta.tar.gz"
'arm.patch'
'style.patch'
'warnings.patch')
sha1sums=('95be2296fab6cf93a7275dbad78798a732c6fbce'
          'd7f908b81b3eb87e328546a0aa7ada4e317278d9'
          '8653c94b9466a83fb5f0d4b7343771543c1ebb0c'
          '14034b3cf09d050efb6daeeac12d77799561012a')
fi

build(){
  cd "$srcdir/cymothoa-$pkgver-beta"
  if [[ $CARCH == arm* ]]; then
    patch < "$srcdir/arm.patch"
    patch < "$srcdir/style.patch"
  fi
  patch < "$srcdir/warnings.patch"
  make
}

package() {
  cd "$srcdir/cymothoa-$pkgver-beta"

  # Base directories.
  install -dm755 "$pkgdir/usr/bin/"

  # Bin.
  for i in cymothoa bgrep udp_server; do
    install -m755 $i "$pkgdir/usr/bin/$i"
  done
}
